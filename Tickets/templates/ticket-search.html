{% load button_tags %}
{% load input_tags %}

<div class="card-body">
    <form method="get" class="mb-3 row g-2 align-items-center">
        <div class="col-md-3">
            <label for="id_q" class="form-label visually-hidden">Search</label>
            {% input_tag "q" "text" search_query "Search by Subject, Tracking-Code" "form-control" %}
        </div>
        <div class="col-md-2">
            <label for="id_category" class="form-label visually-hidden">Category</label>
            <select name="category" id="id_category" class="form-select">
                <option value="">All Category</option>
                {% for category in categories %}
                    <option value="{{ category.id }}"
                            {% if selected_category == category.id|stringformat:"s" %}selected{% endif %}>
                        {{ category.name }}
                    </option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-2">
            <label class="form-label visually-hidden">Search Mode</label>
            <div class="btn-group w-100" role="group">
                <input type="radio" class="btn-check" name="search_mode" id="search_mode_and" value="and"
                       {% if search_mode == 'and' %}checked{% endif %} autocomplete="off">
                <label class="btn btn-outline-info" for="search_mode_and">AND</label>
                <input type="radio" class="btn-check" name="search_mode" id="search_mode_or" value="or"
                       {% if search_mode == 'or' %}checked{% endif %} autocomplete="off">
                <label class="btn btn-outline-warning" for="search_mode_or">OR</label>
            </div>
        </div>
        <div class="col-md-2">
            <label for="id_priority" class="form-label visually-hidden">Priority</label>
            <select name="priority" id="id_priority" class="form-select">
                <option value="">All Priority</option>
                {% for value, label in priorities %}
                    <option value="{{ value }}" {% if selected_priority == value %}selected{% endif %}>
                        {{ label|title }}
                    </option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-3">
            <div class="d-flex gap-2" style="height: 38px;">
                {% button label="Filter" color="warning" type="submit" icon="bi-play-circle" extra_class="flex-fill" %}

                {% url "tickets" as tickets_url %}
                {% button "Clear" url=tickets_url color="danger" icon="bi-arrow-clockwise" extra_class="flex-fill d-flex align-items-center justify-content-center" %}
            </div>
        </div>
        {#    ---------------------------------------------------------------------------------------#}
        {#        <div class="col-md-3">#}
        {#            <div class="form-check form-switch">#}
        {#                <input class="form-check-input"#}
        {#                       type="checkbox"#}
        {#                       role="switch"#}
        {#                       id="switchCheckChecked"#}
        {#                       name="with_close"#}
        {#                        {% if with_close == "on" %}#}
        {#                       checked#}
        {#                        {% endif %}>#}
        {#                <label class="form-check-label" for="switchCheckChecked">With Close Tickets</label>#}
        {#            </div>#}
        {#        </div>#}
        {#    ---------------------------------------------------------------------------------------------#}

        <div class="col-md-3">
            <div class="form-check form-switch">
                <input class="form-check-input"
                       type="checkbox"
                       role="switch"
                       id="switchCheckChecked"
                       name="with_close"
                       {% if with_close == "on" %}checked data-checked="true"{% endif %}
                       onchange="this.dataset.checked = this.checked">
                <label class="form-check-label" for="switchCheckChecked">With Close Tickets</label>
            </div>
        </div>

        <style>
            .form-check-input[data-checked="true"] {
                background-color: #0d6efd !important;
                border-color: #0d6efd !important;
            }
        </style>

    </form>
</div>

